<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta productName="viewport" content="width=device-width, initial-scale=1.0">
    <title>테스트</title>
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <script type="text/javascript">
        const acaoUrl = "https://cors-anywhere.herokuapp.com/";
        const baseUrl = "http://openapi.11st.co.kr/openapi/OpenApiService.tmall";
        const apiKey = "d31cb5254083f025e9231e22960e7e14";
        let searchKeyword = "";//"xnote";

        $(document).ready(function () {
            console.log("ready");
            $("#btnSearch").on("click", function () {
                searchKeyword = document.getElementById("searchKeyword").value;
                console.log(searchKeyword);
                let url = acaoUrl + baseUrl
                    + "?key=" + apiKey
                    + "&apiCode=ProductSearch&keyword=" + searchKeyword;
                let html = "";
                $.ajax({
                    method: "GET",
                    datatype: "xml",
                    url: url,
                    success: function (xml) {
                        $(xml).find("Product").each(function () {
                            let producUrl = $(this).find("DetailPageUrl").text();
                            let productName = $(this).find("ProductName").text();
                            let productImg =  $(this).find("ProductImage").text();
                            let productPrice = $(this).find("ProductPrice").text();
                            let productRating = $(this).find("Rating").text();
                            html += "<li><div onclick=location.href='" + producUrl + "'>"
                                + "<img src="+productImg+" alt='상품 이미지'>"
                                + "<h3>" + productName + "</h3>"
                                + "<p>" + productPrice
                                + "<p>" + productRating
                                + "</div></li>";
                            $("#productList").html(html);
                        });
                    }
                });
            });
        });
    </script>
</head>

<body>
    <h1>Test HTML code</h1>
    <form method="post" action="/process/products">
        <input type="text" id="searchKeyword" />
        <input type="button" id="btnSearch" value="검색" />
    </form>
    <div id="productList"></div>
</body>

</html>